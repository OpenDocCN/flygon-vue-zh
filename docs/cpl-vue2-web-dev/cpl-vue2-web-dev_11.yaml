- en: Building an E-Commerce Store - Adding a Checkout
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建电子商务商店-添加结账功能
- en: Over the last couple of chapters, we have been creating an e-commerce store.
    So far, we have created a product page that allows us to view the images and product
    variations, which may be size or style. We have also created a category page with
    filters and pagination—including a homepage category page that features specific,
    selected products.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去的几章中，我们创建了一个电子商务商店。到目前为止，我们已经创建了一个产品页面，允许我们查看图像和产品变体，可能是尺寸或样式。我们还创建了一个带有过滤器和分页的类别页面，包括一个主页类别页面，其中包含特定的选定产品。
- en: 'Our users can browse and filter products and view more information about a
    specific product. We are now going to:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的用户可以浏览和筛选产品，并查看有关特定产品的更多信息。现在我们要做的是：
- en: Build the functionality to allow the user to add and remove products to their
    basket
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建功能，允许用户将产品添加到购物篮中并从中删除
- en: Allow a user to Checkout
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 允许用户结账
- en: Add an Order Confirmation page
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加订单确认页面
- en: As a reminder—we won't be taking any billing details but we will make an Order
    Confirmation screen.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 提醒一下-我们不会获取任何账单详细信息，但我们会创建一个订单确认屏幕。
- en: Creating the basket array placeholder
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建购物篮数组占位符
- en: To help us persist the products in the basket throughout the app, we are going
    to be storing the user's selected products in the Vuex store. This will be in
    the form of an array of objects. Each object will contain several key pieces of
    information that will allow us to display the products in the basket without having
    to query the Vuex store each time. It also allows us to store details about the
    current state of the product page—remembering the image updates when a variant
    is selected.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助我们在整个应用程序中持久保存购物篮中的产品，我们将把用户选择的产品存储在Vuex存储中。这将以对象数组的形式存在。每个对象将包含几个关键信息，这些信息将允许我们在不必每次查询Vuex存储时都能显示购物篮中的产品。它还允许我们存储有关产品页面当前状态的详细信息-当选择变体时，记住图像更新。
- en: 'The details we''re going to store for each product added to the basket are
    as follows:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将为添加到购物篮中的每个产品存储以下详细信息：
- en: Product title
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产品标题
- en: Product handle, so we can link back to the product
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产品句柄，以便我们可以链接回产品
- en: Selected variation title (as it appears in the select box)
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选定的变体标题（在选择框中显示）
- en: Currently selected image, so we can show an appropriate image in the Checkout
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当前选定的图像，以便我们可以在结账时显示适当的图像
- en: Variation details, this contains price and weight along with other details
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 变体详细信息，包括价格、重量和其他细节
- en: Variation SKU, this will help us identify whether the product has already been
    added
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 变体SKU，这将帮助我们确定产品是否已经添加
- en: Quantity, how many items the user has added to their basket
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数量，用户已添加到购物篮中的物品数量
- en: 'As we will be storing all this information within an object, contained in an
    array, we need to create a placeholder array within the store. Add a new key to
    the `state` object within the store titled `basket` and make it a blank array:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们将把所有这些信息存储在一个对象中，该对象包含在一个数组中，我们需要在存储中创建一个占位符数组。在存储的`state`对象中添加一个名为`basket`的新键，并将其设置为空数组：
- en: '[PRE0]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Adding product information to the store
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将产品信息添加到存储中
- en: With our `basket` array ready to receive data, we can now create a mutation
    to add the product object. Open the `ProductPage.js` file and update the `addToBasket`
    method to call a `$store` commit function, instead of the `alert` we put in place.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 准备好我们的`basket`数组来接收数据后，我们现在可以创建一个mutation来添加产品对象。打开`ProductPage.js`文件，更新`addToBasket`方法，调用`$store`的commit函数，而不是我们放置的`alert`。
- en: All of the information we require for products to be added to the basket is
    stored on the `ProductPage` component—so we can pass the component instance through
    to the `commit()` function using the `this` keyword.  This will become clear when
    we build the mutation.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要将产品添加到购物篮的所有所需信息都存储在`ProductPage`组件上，因此我们可以使用`this`关键字将组件实例传递给`commit()`函数。当我们构建突变时，这将变得清晰。
- en: 'Add the function call to the `ProductPage` method:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 将函数调用添加到`ProductPage`方法中：
- en: '[PRE1]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Creating the store mutation to add products to the basket
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建存储突变以将产品添加到购物篮中
- en: 'Navigate to the Vuex store and create a new mutation titled `addToBasket`.
    This will accept the `state` as the first parameter and the component instance
    as the second. Passing the instance through allows us to access the variables,
    methods, and computed values on the component:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 转到Vuex存储并创建一个名为`addToBasket`的新突变。这将接受`state`作为第一个参数，组件实例作为第二个参数。通过传递实例，我们可以访问组件上的变量、方法和计算值。
- en: '[PRE2]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: We can now proceed with adding the products to the `basket` array. The first
    step is to add the product object with the mentioned properties. As it's an array,
    we can use the `push()` function to add the object.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以继续将产品添加到`basket`数组中。第一步是添加具有所述属性的产品对象。由于它是一个数组，我们可以使用`push()`函数来添加对象。
- en: 'Next, add an object to the array, using the `item` and its properties to build
    the object. With access to the `ProductPage` component, we can construct the variant
    title as it appears in the select box, using the `variantTitle` method. Set the
    quantity to `1` by default:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用`item`及其属性构建对象，将对象添加到数组中。通过访问`ProductPage`组件，我们可以使用`variantTitle`方法构建变体标题，该标题将显示在选择框中。默认情况下，将数量设置为`1`：
- en: '[PRE3]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This now adds the product to the `basket` array. An issue appears, however,
    when you add two of the same item to the basket. Rather than increasing the `quantity`,
    it simply adds a second product.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，将产品添加到`basket`数组中。然而，当您将两个相同的商品添加到购物篮时，会出现一个问题。它不会增加`quantity`，而是简单地添加第二个产品。
- en: This can be remedied by checking if the `sku` exists within the array already.
    If it does, we can increment the quantity on that item, if not we can add a new
    item to the `basket` array. The `sku` is unique for each variation of each product.
    Alternatively, we could use the barcode property.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过检查数组中是否已存在`sku`来解决此问题。如果存在，我们可以增加该商品的数量，如果不存在，我们可以将新商品添加到`basket`数组中。每个产品的每个变体的`sku`是唯一的。或者，我们可以使用条形码属性。
- en: 'Using the native `find` JavaScript function, we can identify any products that
    have an SKU matching that of the one being passed in:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 使用原生的`find` JavaScript函数，我们可以识别出具有与传入的SKU相匹配的任何产品：
- en: '[PRE4]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'If it matches, we can increment the quantity by one on that object, using the
    `++` notation in JavaScript. If not, we can add the new object to the `basket`
    array. When using the `find` function, we can return the product if it exists.
    If not, we can add a new item:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如果匹配，我们可以使用JavaScript中的`++`符号将该对象的数量增加一。如果不匹配，我们可以将新对象添加到`basket`数组中。使用`find`函数时，如果产品存在，我们可以返回该产品。如果不存在，我们可以添加一个新商品：
- en: '[PRE6]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: We now have a basket being populated as the item is added to the basket, and
    incrementing when it exists already.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，当商品添加到购物篮中时，购物篮会被填充，并且在已存在时会递增。
- en: To improve the usability of the app, we should give the user some feedback when
    they have added an item to the basket. This can be done by updating the Add to
    Basket button briefly and showing a product count with a link to the basket in
    the header of the site.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提高应用的可用性，当用户将商品添加到购物篮时，我们应该给予用户一些反馈。可以通过更新“添加到购物篮”按钮并在网站头部显示一个带有指向购物篮的链接的产品计数来实现这一点。
- en: Updating the Add to basket button when adding an item
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在添加商品时更新“添加到购物篮”按钮
- en: As a usability improvement to our shop, we are going to update the Add to basket
    button when a user clicks it. This will change to Added to your basket and apply
    a class for a set period of time, for example, two seconds, before returning to
    its previous state. The CSS class will allow you to style the button differently—for
    example, changing the background to green or transforming it slightly.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 作为对我们商店的可用性改进，当用户点击“添加到购物篮”按钮时，我们将更新该按钮。它将变为“已添加到您的购物篮”，并在一段时间内应用一个类，例如两秒钟，然后返回到之前的状态。CSS类将允许您对按钮进行不同的样式设置，例如将背景改为绿色或稍微进行变换。
- en: This will be achieved by using a data property on the component—setting it to
    `true` and `false` as the item gets added. The CSS class and text will use this
    property to determine what to show and a `setTimeout` JavaScript function will
    change the state of the property.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在组件上使用一个数据属性来实现这一点，将其设置为`true`和`false`，当商品被添加时。CSS类和文本将使用此属性来确定要显示的内容，而`setTimeout`
    JavaScript函数将更改属性的状态。
- en: 'Open the `ProductPage` component and add a new key to the data object titled
    `addedToBasket`. Set this to `false` by default:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 打开`ProductPage`组件，并在数据对象中添加一个名为`addedToBasket`的新键。默认将其设置为`false`：
- en: '[PRE7]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Update the button text to allow for this variation. As there is already a ternary
    `if`, within this, we are going to nest them with another one. This could be abstracted
    into a method if desired.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 更新按钮文本以适应这个变化。由于已经有一个三元`if`，我们将在其中嵌套另一个。如果需要，这可以抽象成一个方法。
- en: 'Replace the `Add to basket` condition in your button with an additional ternary
    operator, dependent on whether the `addedToBasket` variable is true. We can also
    add a conditional class based on this property:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在按钮中，用一个额外的三元运算符替换`Add to basket`条件，取决于`addedToBasket`变量是否为true。我们还可以根据此属性添加一个条件类：
- en: '[PRE8]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Refresh the app and navigate to a product to ensure the correct text is being
    shown. Update the `addedToBasket` variable to `true` to make sure everything is
    displaying as it should. Set it back to `false`.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 刷新应用并导航到一个产品页面，确保正确的文本被显示。将`addedToBasket`变量更新为`true`，以确保一切都显示正常。然后将其设置回`false`。
- en: 'Next, within the `addToBasket()` method, set the property to true. This should
    update the text when the item is added to the basket:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，在`addToBasket()`方法中，将该属性设置为true。当商品被添加到购物篮时，这将更新文本：
- en: '[PRE10]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'When you click the button, the text will now update, however it will never
    reset. Add a `setTimeout` JavaScript function afterward, which sets it back to
    `false` after a certain period of time:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 当您点击按钮时，文本现在会更新，但它永远不会重置。在之后添加一个`setTimeout` JavaScript函数，它会在一定时间后将其设置回`false`：
- en: '[PRE11]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The timing for `setTimeout` is in milliseconds, so `2000` is equal to two seconds.
    Feel free to tweak and play with this figure as much as you see fit.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '`setTimeout`的时间单位是毫秒，所以`2000`等于两秒。根据需要随意调整和修改这个数字。'
- en: 'One last addition would be to reset this value back to `false` if the variation
    is updated or the product is changed. Add the statement to both `watch` functions:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个添加是，如果变体被更新或产品被更改，将此值重置为`false`。将该语句添加到两个`watch`函数中：
- en: '[PRE12]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Showing the product count in the header of the app
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在应用的页眉中显示产品数量
- en: It's common practice for a shop to show a link to the cart in the site's header—along
    with the number of items in the cart next to it. To achieve this, we'll use a
    Vuex getter to calculate and return the number of items in the basket.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在网站的页眉中显示购物车链接以及购物车中的商品数量是常见的做法。为了实现这一点，我们将使用一个Vuex getter来计算并返回购物篮中的商品数量。
- en: 'Open the `index.html` file and add a `<header>` element to the app HTML and
    insert a placeholder, `span`—we''ll convert this to a link once we''ve set up
    the routes. Within the span, output a `cartQuantity` variable:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 打开`index.html`文件并在应用程序HTML中添加一个`<header>`元素，并插入一个占位符`span` - 一旦我们设置了路由，我们将把它转换为链接。在span中，输出一个`cartQuantity`变量：
- en: '[PRE13]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Navigate to your `Vue` instance and create a `computed` object containing a
    `cartQuantity` function:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 转到你的`Vue`实例并创建一个包含`cartQuantity`函数的`computed`对象：
- en: '[PRE14]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: If our header were to feature more items than our cart link, it would be advisable
    to abstract it out into a separate component to keep the methods, layout, and
    functions contained. However, as it is only going to feature this one link in
    our example app, adding the function to the `Vue` instance will suffice.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们的标题中的商品比购物车链接多，最好将其抽象为一个单独的组件，以保持方法、布局和函数的封装。然而，由于在我们的示例应用程序中只会显示这一个链接，将函数添加到`Vue`实例中就足够了。
- en: 'Create a new getter in the store titled `cartQuantity`.  As a placeholder,
    return `1`. The `state` will be required to calculate the quantity, so ensure
    that is passed into the function for now:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在store中创建一个名为`cartQuantity`的新getter。作为占位符，返回`1`。`state`将被用于计算数量，所以现在确保将其传递给函数：
- en: '[PRE15]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Head back to your `Vue` instance and return the result of the getter. Ideally,
    we want to show the count of the `basket` in brackets, but we only want to show
    the brackets if there are items. Within the computed function, check the result
    of this getter and output the result with brackets if the result exists:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 返回到你的`Vue`实例并返回getter的结果。理想情况下，我们希望在括号中显示`basket`的数量，但只有在有商品时才显示括号。在计算函数中，检查这个getter的结果，并在结果存在时输出带有括号的结果：
- en: '[PRE16]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Changing the result within the Vuex getter should reveal either the number in
    brackets or nothing at all.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在Vuex getter中更改结果应该会显示带括号的数字或根本不显示任何内容。
- en: Calculating the basket quantity
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 计算购物篮数量
- en: With the display logic in place, we can now proceed with calculating how many
    items are in the basket. We could count the number of items in the `basket` array,
    however, this will only tell us how many different products are there now and
    not if the same product was added many times.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 有了显示逻辑，我们现在可以继续计算购物篮中有多少商品。我们可以计算`basket`数组中的商品数量，但是这只会告诉我们现在有多少不同的商品，而不是同一种商品被添加了多次。
- en: 'Instead, we need to loop through each product in the basket and add the quantities
    together. Create a variable called `quantity` and set it to `0`. Loop through
    the basket items and add the `item.quantity` variable to the `quantity` variable.
    Lastly, return our variable with the right sum:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，我们需要遍历购物篮中的每个商品并将数量相加。创建一个名为`quantity`的变量并将其设置为`0`。遍历购物篮中的商品并将`item.quantity`变量添加到`quantity`变量中。最后，返回我们的变量与正确的总和：
- en: '[PRE17]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Navigate to the app and add some items to your basket to verify the basket count
    is being calculated correctly.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 转到应用程序并添加一些商品到购物篮中，以验证购物篮数量是否被正确计算。
- en: Finalizing the Shop Vue-router URLs
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最终确定Shop Vue-router的URL
- en: 'We''re now at a stage where we can finalize the URLs for our shop - including
    creating the redirects and Checkout links. Referring back to Chapter 8, *Introducing
    Vue-Router and Loading URL-Based Components*, we can see which ones we are missing.
    These are:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在处于一个可以最终确定我们商店的URL的阶段 - 包括创建重定向和结账链接。回顾第8章，*介绍Vue-Router和加载基于URL的组件*，我们可以看到我们缺少哪些。这些是：
- en: '`/category` -redirect to `/`'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/category` - 重定向到`/`'
- en: '`/product` - redirect to `/`'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/product` - 重定向到`/`'
- en: '`/basket` - load `OrderBasket` component'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/basket` - 加载`OrderBasket`组件'
- en: '`/checkout`- load `OrderCheckout` component'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/checkout` - 加载`OrderCheckout`组件'
- en: '`/complete`- load `OrderConfirmation` component'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/complete` - 加载`OrderConfirmation`组件'
- en: 'Create the redirects in the appropriate places within the routes array. At
    the bottom of the routes array, create three new routes for the `Order` components:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在路由数组的适当位置创建重定向。在路由数组的底部，为`Order`组件创建三个新路由：
- en: '[PRE18]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'We can now update the placeholder `<span>` in the header of our app with a
    `router-link`:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以使用`router-link`来更新应用程序标题中的占位符`<span>`：
- en: '[PRE19]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Building the Order process and ListProducts component
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建订单流程和ListProducts组件
- en: 'For the three steps of the Checkout, we are going to be utilizing the same
    component in all three: the `ListProducts` component. In the `OrderCheckout`, and
    `OrderConfirmation` components, it will be in a fixed, uneditable state, whereas
    when it is in the `OrderBasket` component, the user needs to be able to update
    quantities and remove items if desired.'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 对于结账的三个步骤，我们将在所有三个步骤中使用相同的组件：`ListProducts`组件。在`OrderCheckout`和`OrderConfirmation`组件中，它将处于固定的、不可编辑的状态，而在`OrderBasket`组件中，用户需要能够更新数量和删除物品。
- en: As we're going to be working at the Checkout, we need products to exist in the
    `basket` array. To save us having to find products and add them to the basket
    every time we refresh the app, we can ensure there are some products in the `basket`
    array by hardcoding an array in the store.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们将在结账时进行操作，我们需要在`basket`数组中存在产品。为了避免每次刷新应用程序时都要查找产品并将其添加到购物篮中，我们可以通过在存储中硬编码一个数组来确保`basket`数组中有一些产品。
- en: 'To achieve this, navigate to a few products and add them to your basket. Ensure
    there is a good selection of products and quantities for testing. Next, open your
    JavaScript console in the browser and enter the following command:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实现这一点，导航到一些产品并将它们添加到购物篮中。确保有一些产品和数量进行测试。接下来，在浏览器中打开JavaScript控制台并输入以下命令：
- en: '[PRE20]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'This will output a string of your products array. Copy this and paste it into
    your store—replacing the `basket` array:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这将输出一个您的产品数组的字符串。将其复制并粘贴到您的存储中，替换`basket`数组：
- en: '[PRE21]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: On page load, your Cart count in the header should update to be the correct
    number of items you added.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 页面加载时，标题中的购物车计数应更新为您添加的正确数量的物品。
- en: We can now proceed with building our Checkout process. The product display in
    the basket is more complicated than the Checkout and Order Confirmation screens
    so, unusually, we'll work backward. Starting with the Order Confirmation page
    and moving to the Checkout page, adding more complexity before we head to the
    basket, adding the ability to exit the products.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以继续构建我们的结账流程了。购物篮中的产品显示比结账和订单确认屏幕更复杂，因此我们将反向工作。从订单确认页面开始，然后转到结账页面，在前往购物篮之前增加更多复杂性，添加退出产品的功能。
- en: Order Confirmation screen
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 订单确认屏幕
- en: The Order Confirmation screen is one that is shown once the order is complete.
    This confirms the items purchased and may include the expected delivery date.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 订单确认屏幕是在订单完成后显示的屏幕。它确认购买的物品，并可能包括预计的交货日期。
- en: 'Create a template within the `OrderConfirmation.js` file with a `<h1>` and
    some relevant content relating to the order being complete:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在`OrderConfirmation.js`文件中创建一个包含`<h1>`和与订单完成相关的一些相关内容的模板：
- en: '[PRE22]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Open up the application in your browser, add a product to your basket and complete
    an order to confirm it''s working. The next step is to include the `ListProducts`
    component. First, ensure the `ListProducts` component is correctly initialized
    and features an initial template:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在浏览器中打开应用程序，将产品添加到购物篮中并完成订单以确认其是否正常工作。下一步是包含`ListProducts`组件。首先，确保`ListProducts`组件正确初始化并具有初始模板：
- en: '[PRE23]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Add the `components` object to the `OrderConfirmation` component and include
    the `ListProducts` component. Next, include it in the template:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 将`components`对象添加到`OrderConfirmation`组件中，并包含`ListProducts`组件。接下来，在模板中包含它：
- en: '[PRE24]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Open the `ListPurchases` component once more to start displaying the products.
    The default state of this component will be to list the products in the basket,
    along with the variation selected. The price for each product will be displayed,
    along with the price if the quantity is more than one. Lastly, a grand total will
    be shown.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 再次打开`ListPurchases`组件以开始显示产品。该组件的默认状态将是列出购物篮中的产品，以及所选的变体。每个产品的价格将被显示出来，如果数量大于一，则还会显示价格。最后，将显示一个总计。
- en: 'The first step is to get the basket list into our component. Create a `computed`
    object with a `products` function. This should return the basket products:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是将购物篮列表放入我们的组件中。创建一个带有`products`函数的`computed`对象。这个函数应该返回购物篮中的产品：
- en: '[PRE25]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'With the products in the basket now available to us, we can loop through them
    in the table displaying the information required. This includes a thumbnail image,
    the product and variation title, price, quantity, and the total price of the item.
    Add a header row to the table too, so the user knows what the column is:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以在表格中循环遍历购物篮中的产品，并显示所需的信息。这包括缩略图、产品和变体标题、价格、数量和项目的总价格。还要在表格中添加一个标题行，以便用户知道每列的内容：
- en: '[PRE26]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Note that the price for each row is simply the unit price multiplied by the
    quantity. We now have a standard product list of the items the user has purchased.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，每行的价格只是单位价格乘以数量。现在我们有了用户购买的标准产品列表。
- en: Using Vue filters to format the price
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Vue过滤器格式化价格
- en: The price is currently an integer, as that it is in the data. On the product
    page, we just prepended a `$` sign to represent a price, however, this is now
    the perfect opportunity to utilize Vue filters. Filters allow you to manipulate
    the data in the template without using a method. Filters can be chained and are
    used to carry out, generally, a single modification—for example converting a string
    to lowercase or formatting a number to be a currency.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 价格目前是一个整数，因为它在数据中是这样的。在产品页面上，我们只是在价格前面加了一个“$”符号来表示价格，然而，现在正是利用Vue过滤器的绝佳机会。过滤器允许您在模板中操作数据，而无需使用方法。过滤器可以链接在一起，用于执行通常的单一修改，例如将字符串转换为小写或将数字格式化为货币。
- en: 'Filters are used with the pipe (`|`) operator. If, for example, we had a filter
    to lowercase text, it would be used like the following:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤器使用管道（`|`）运算符。例如，如果我们有一个将文本转换为小写的过滤器，可以像下面这样使用它：
- en: '[PRE27]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Filters are declared within a `filters` object on the component and accept a
    single parameter of the output preceding it.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤器在组件的`filters`对象中声明，并接受一个输出前置参数。
- en: 'Create a `filters` object within the `ListPurchases` component and create a
    function inside titled `currency()`. This function accepts a single parameter
    of `val` and should return the variable inside:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在`ListPurchases`组件中创建一个`filters`对象，并在其中创建一个名为`currency()`的函数。这个函数接受一个名为`val`的参数，并应该返回该变量的值：
- en: '[PRE28]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'We can now use this function to manipulate the price integers. Add the filter
    to both the unit and total price within the template:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以使用这个函数来操作价格整数。在模板中将过滤器添加到单位价格和总价格中：
- en: '[PRE29]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'You won''t notice anything in the browser, as we have yet to manipulate the
    value. Update the function to ensure the number is fixed to two decimal places
    and has a `$` preceding it:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在浏览器中您不会注意到任何变化，因为我们还没有对值进行操作。更新函数以确保数字保留两位小数，并在前面加上“$”符号：
- en: '[PRE30]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Our prices are now nicely formatted and displaying correctly.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的价格现在已经很好地格式化并正确显示。
- en: Calculating a total price
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 计算总价格
- en: The next addition to our purchase list is a total value of the basket. This
    will need to be calculated in a similar way to the basket count we did earlier.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 购物清单的下一个添加是购物篮的总价值。这需要以与我们之前计算购物篮数量的方式进行计算。
- en: 'Create a new `computed` function title: `totalPrice`. This function should
    loop through the products and add the price up, taking into consideration any
    multiple quantities:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的`computed`函数标题为`totalPrice`。该函数应该循环遍历产品并累加价格，考虑到任何多个数量：
- en: '[PRE31]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'We can now update our template to include the total price—ensuring we pass
    it through the `currency` filter:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以更新模板以包括总价格 - 确保我们通过`currency`过滤器传递它：
- en: '[PRE32]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Creating an Order Checkout page
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个订单结账页面
- en: 'Our `OrderCheckout` page will have a similar makeup to the `OrderConfirmation`
    page - however, in a real shop, this would be the page before payment. This page
    would allow the user to fill in their billing and delivery details before navigating
    to the payment page. Copy the `OrderConfirmation` page and update the title and
    info text:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的`OrderCheckout`页面的构成与`OrderConfirmation`页面类似 - 但是，在真实的商店中，这将是付款之前的页面。该页面允许用户在导航到付款页面之前填写其帐单和交付详细信息。复制`OrderConfirmation`页面并更新标题和信息文本：
- en: '[PRE33]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Below the `<list-purchases />` component, create a form with several fields
    so we can collect the billing and delivery name and addresses. For this example,
    just collect the name, first line of the address, and ZIP code:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在`<list-purchases />`组件下方，创建一个表单，包含几个字段，以便我们可以收集帐单和交付名称和地址。对于这个示例，只需收集姓名、地址的第一行和邮政编码：
- en: '[PRE34]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'We now need to create a data object and bind each field to a key. To help group
    each set, create an object for both `delivery` and `billing` and create the fields
    inside with the correct names:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要创建一个数据对象，并将每个字段绑定到一个键。为了帮助分组每个集合，为`delivery`和`billing`分别创建一个对象，并在内部创建正确名称的字段：
- en: '[PRE35]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Add a `v-model` to each input, linking it to the appropriate data key:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 为每个输入添加`v-model`，将其链接到相应的数据键：
- en: '[PRE36]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The next step is to create a `submit` method and collate the data to be able
    to pass it on to the next screen. Create a new method titled `submitForm()`. As
    we are not handling payment in this example, we can route to the confirmation
    page in the method:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是创建一个`submit`方法并整理数据以便能够将其传递给下一个屏幕。创建一个名为`submitForm()`的新方法。由于本示例中不处理付款，所以可以在该方法中路由到确认页面：
- en: '[PRE37]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: We can now bind a `submit` event to the form and add a submit button. Like the
    `v-bind:click` attribute (or `@click`), Vue allows you to bind a `submit` event
    to a method using a `@submit=""` attribute.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以将`submit`事件绑定到表单上，并添加一个提交按钮。与`v-bind:click`属性（或`@click`）类似，Vue允许您使用`@submit=""`属性将`submit`事件绑定到一个方法上。
- en: 'Add the declaration to the `<form>` element and create a submit button in your
    form:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在`<form>`元素中添加声明并在表单中创建一个提交按钮：
- en: '[PRE38]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: On submitting your form, the app should redirect you to our Confirmation page.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在提交表单时，应用程序应将您重定向到我们的确认页面。
- en: Copying details between addresses
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在地址之间复制详细信息
- en: 'One feature that several shops have is the ability to mark the delivery address
    to be the same as the billing address. There are several ways we could approach
    this, and how you choose to do it is up to you. The immediate options are:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 几个商店都有的一个功能是将交付地址标记为与帐单地址相同。我们可以采用几种方法来实现这一点，您可以根据自己的选择来做。即时选项有：
- en: Have a "copy details" button—this copies the details from billing to delivery
    but does not keep them in sync
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有一个“复制详细信息”按钮 - 这将从帐单复制详细信息到交付，但不会保持它们同步
- en: Have a checkbox that keeps the two in sync—checking the box disables the delivery
    box fields but populates them with the billing details
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有一个复选框，可以保持两者同步 - 勾选该框会禁用交付框字段，但会填充帐单详细信息
- en: For this example, we are going to code the second option.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个示例，我们将编写第二个选项。
- en: 'Create a checkbox between the two fieldsets that is bound to a property in
    the data object via `v-model` called `sameAddress`:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在两个字段集之间创建一个复选框，通过`v-model`将其绑定到数据对象中的一个属性`sameAddress`：
- en: '[PRE39]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Create a new key in the data object and set it to `false` by default:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据对象中创建一个新的键，并将其默认设置为`false`：
- en: '[PRE40]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The next step is to disable the delivery fields if the checkbox is checked.
    This can be done by activating the  `disabled` HTML attribute based on the checkbox
    result. In a similar way to how we disabled the "Add to cart" button on the product
    page, bind the disabled attribute on the delivery fields to the `sameAddress`
    variable:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是如果复选框被选中，则禁用delivery字段。这可以通过根据复选框的结果激活`disabled`HTML属性来实现。类似于我们在产品页面上禁用“添加到购物车”按钮的方式，将delivery字段上的disabled属性绑定到`sameAddress`变量上：
- en: '[PRE41]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Checking the box will now deactivate the fields - making the user unable to
    enter any data. The next step is to replicate the data across the two sections.
    As our data objects are the same structure, we can create a `watch` function to
    set the `delivery` object to the same as the `billing` object when the checkbox
    is checked.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 现在勾选复选框将禁用字段，使用户无法输入任何数据。下一步是在两个部分之间复制数据。由于我们的数据对象具有相同的结构，我们可以创建一个`watch`函数，当复选框被选中时，将`delivery`对象设置为与`billing`对象相同。
- en: 'Create a new `watch` object and function for the `sameAddress` variable. If
    it is `true`, set the delivery object to the same as the billing one:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的`watch`对象和函数来处理`sameAddress`变量。如果它为`true`，则将delivery对象设置为与billing对象相同：
- en: '[PRE42]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: With the `watch` function added, we can enter data into the billing address,
    check the box, and the delivery address gets populated. The best thing about this
    is that they now stay in sync, so if you update the billing address, the delivery
    address updates on the fly. The problem arises when you uncheck the box and edit
    the billing address—the delivery address still updates. This is because we have
    bound the objects together.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 添加了`watch`函数后，我们可以输入数据到billing地址，勾选复选框，然后delivery地址会自动填充。最好的是它们现在保持同步，所以如果你更新billing地址，delivery地址会实时更新。问题出现在当你取消勾选复选框并编辑billing地址时，delivery地址仍然会更新。这是因为我们将这两个对象绑定在一起。
- en: 'Add an `else` statement to make a *copy* of the billing address when the box
    is unchecked:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 添加一个`else`语句，当复选框未选中时，复制billing地址：
- en: '[PRE43]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: We now have a functioning Order Confirmation page, which collects billing and
    delivery details.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个功能完善的订单确认页面，可以收集账单和交付细节。
- en: Creating an editable basket
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建可编辑的购物篮
- en: We now need to create our basket. This needs to show the products in a similar
    fashion to the Checkout and Confirmation, but it needs to give the user the ability
    to edit the basket contents—either to delete an item or update the quantity.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要创建我们的购物篮。它需要以类似于结账和确认页面的方式显示产品，但它需要给用户编辑购物篮内容的能力-删除项目或更新数量。
- en: 'As a starting point, open `OrderBasket.js` and include the `list-purchases`
    component, as we did on the confirmation page:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 作为起点，打开`OrderBasket.js`并包含`list-purchases`组件，就像我们在确认页面上所做的那样：
- en: '[PRE44]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'The next thing we need to do is edit the `list-purchases` component. To ensure
    we can differentiate between the views, we are going to add an `editable` prop.
    This will be set to `false` by default and `true` in the basket. Add the `prop` to
    the component in the basket:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来我们需要编辑`list-purchases`组件。为了确保我们可以区分视图，我们将添加一个`editable`属性。默认情况下设置为`false`，在购物篮中设置为`true`。在购物篮中的组件中添加这个属性：
- en: '[PRE45]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'We now need to tell the `ListPurchases` component to accept this parameter
    so we can do something with it within the component:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要告诉`ListPurchases`组件接受这个参数，以便我们可以在组件内部对其进行操作：
- en: '[PRE46]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Creating editable fields
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建可编辑字段
- en: We now have a prop determining if our basket should be editable or not. This
    allows us to show the delete links and make the quantity an editable box.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个属性来确定我们的购物篮是否可编辑。这允许我们显示删除链接并使数量成为可编辑框。
- en: 'Create a new table cell next to the quantity one in the `ListPurchases` component
    and make it visible only when the purchases are visible. Make the static quantity
    hidden in this state too. In the new cell, add an input box with the value set
    to the quantity. We are also going to bind a `blur` event to the box. The `blur`
    event is a native JavaScript event that triggers when the input is unfocused.
    On blur, trigger an `updateQuantity` method. This method should accept two arguments;
    the event, which will contain the new quantity, and the SKU for that particular
    product:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在`ListPurchases`组件中，在数量旁边创建一个新的表格单元格，并仅在购买可见时显示它。在这种状态下，将静态数量隐藏。在新的单元格中，添加一个值设置为数量的输入框。我们还将绑定一个`blur`事件到该框。`blur`事件是一个原生JavaScript事件，当输入框失去焦点时触发。在失去焦点时，触发一个`updateQuantity`方法。该方法应该接受两个参数：事件，其中包含新的数量，以及该特定产品的SKU：
- en: '[PRE47]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: Create the new method on the component. This method should loop through the
    products, locating the one with a matching SKU and updating the quantity to an
    integer. We also need to update the store with the result - so that the quantity
    can be updated at the top of the page. We'll create a general mutation that accepts
    the full `basket` array back with new values to allow the same one to be used
    for the product deletion.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在组件上创建新的方法。该方法应该循环遍历产品，找到具有匹配SKU的产品并将数量更新为整数。我们还需要更新存储的结果，以便在页面顶部更新数量。我们将创建一个通用的mutation，接受带有新值的完整`basket`数组，以允许相同的mutation用于产品删除。
- en: 'Create the mutation that updates the quantity and commits a mutation titled `updatePurchases`:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 创建更新数量并提交名为`updatePurchases`的mutation：
- en: '[PRE48]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'In the store, create the mutation that sets the `state.basket` equal to the
    payload:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在store中，创建将`state.basket`设置为payload的mutation：
- en: '[PRE49]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Updating the quantity should now update the total price of the item and the
    basket count at the top of the page.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，更新数量应该更新页面顶部的商品总价和购物车数量。
- en: Removing items from your cart
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从购物车中删除商品
- en: 'The next step is to give the user the ability to remove items from their cart.
    Create a button in the `ListPurchases` component with a click binding. This button
    can go anywhere you want - our example shows it as an extra cell at the end of
    the row. Bind the click action to a method titled `removeItem`. This just needs
    to accept a single parameter of the SKU. Add the following to the `ListPurchases`
    component:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是让用户能够从购物车中删除商品。在`ListPurchases`组件中创建一个带有点击绑定的按钮。这个按钮可以放在任何你想要的地方 - 我们的示例将其显示为行末的额外单元格。将点击操作绑定到一个名为`removeItem`的方法。这只需要接受一个SKU的参数。在`ListPurchases`组件中添加以下内容：
- en: '[PRE50]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Create the `removeItem` method. This method should filter the `basket` array,
    only returning the objects that *don''t* match the SKU passed in. Once the result
    is filtered, pass the result to the same mutation we used in the `updateQuantity()`
    method:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 创建`removeItem`方法。该方法应该过滤`basket`数组，只返回不匹配传入的SKU的对象。一旦结果被过滤，将结果传递给与`updateQuantity()`方法中使用的相同的mutation：
- en: '[PRE51]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'One last enhancement we can make is to trigger the `removeItem` method if the
    quantity is set to 0\. Within the `updateQuantity` method, check the value before
    looping through the products. If it is `0`, or doesn''t exist, run the `removeItem`
    method - passing the SKU through:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以做的最后一个改进是如果数量设置为0，则触发`removeItem`方法。在`updateQuantity`方法中，在循环遍历产品之前检查值。如果它是`0`或不存在，则运行`removeItem`方法
    - 通过传递SKU：
- en: '[PRE52]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: Completing the shop SPA
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 完成购物SPA
- en: 'The last step is to add a link from the `OrderBasket` component to the `OrderCheckout`
    page. This can be done by linking to the `Checkout` route. With that, your checkout
    is complete, along with your shop! Add the following link to the basket:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一步是从`OrderBasket`组件添加到`OrderCheckout`页面的链接。这可以通过链接到`Checkout`路由来完成。有了这个，您的结账就完成了，您的商店也完成了！在购物篮中添加以下链接：
- en: '[PRE53]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Summary
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Well done! You have created a full shop single-page application using `Vue.js`.
    You have learned how to list products and their variations, along with adding
    specific variations to the basket. You've learned how to create shop filters and
    category links, along with creating an editable shopping basket.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 干得好！您已经使用`Vue.js`创建了一个完整的商店单页面应用程序。您已经学会了如何列出产品及其变体，以及如何将特定的变体添加到购物篮中。您已经学会了如何创建商店过滤器和类别链接，以及创建可编辑的购物篮。
- en: As with everything, there are always improvements to be made. Why don't you
    give some of these ideas a go?
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 就像任何事情一样，总是有改进的空间。为什么不尝试一些这些想法呢？
- en: Persisting the basket using `localStorage`—so products added to the basket are
    retained between visits and the user pressing refresh
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`localStorage`持久化购物篮-这样添加到购物篮中的产品在访问和用户按下刷新之间保留
- en: Calculating shipping based on the weight attribute of the products in the basket—use
    a switch statement to create bands
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据购物篮中产品的重量属性计算运费-使用switch语句创建带有不同范围的运费
- en: Allowing products without variations to be added to the basket from the category
    listing page
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 允许从类别列表页面将没有变体的产品添加到购物篮中
- en: Indicating which products have items out of stock when filtered on that variation
    on the category page
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当在类别页面上过滤某个变体时，指示哪些产品缺货
- en: Any ideas of your own!
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您自己的任何想法！
