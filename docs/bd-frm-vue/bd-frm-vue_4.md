# 第四章：使用 v-mask 进行输入掩码

任何成功表单的关键方面之一是清晰度。如果用户发现表单易于使用和理解，他们更有可能填写并提交表单。在本章中，我们将研究输入掩码。您将学习如何快速轻松地将掩码应用于表单输入，并使用真实示例（如电话号码）根据您的需求进行配置。

究竟什么是输入掩码？它们是预定义的结构，用于显示输入的数据。例如，如果您要对电话输入进行掩码处理，您可能希望它显示为**(123) 234-5555**，而不仅仅是**1232345555**。您可以清楚地看到，第一个示例不仅更容易阅读，而且还传达了字段试图实现的含义。

输入掩码是一个很好的功能，可以将您的 UX 提升到另一个水平，而且非常容易实现，这要归功于开源库，如`v-mask`。GitHub 存储库页面可以在以下链接找到：[`github.com/probil/v-mask`](https://github.com/probil/v-mask)。

在本章中，我们将快速了解如何在现有项目的基础上实现此库。

在本章中，我们将涵盖以下主题：

+   安装`v-mask`库

+   探索`v-mask`指令

+   增强我们的自定义输入

# 技术要求

本章的代码可以在以下 GitHub 存储库中找到：

[`github.com/PacktPublishing/Building-Forms-with-Vue.js/tree/master/Chapter04`](https://github.com/PacktPublishing/Building-Forms-with-Vue.js/tree/master/Chapter04)。

查看以下视频以查看代码的实际操作：

[`bit.ly/31jFmyH`](http://bit.ly/31jFmyH)

# 安装 v-mask 库

让我们开始安装`v-mask`库。为了让我们的项目使用它所提供的功能，我们首先需要将其添加到我们的项目依赖项中。按照以下步骤执行此操作：

1.  打开您的终端并输入以下命令将库添加到我们的依赖项中：

```js
> npm install v-mask
```

1.  我们需要将其添加到 Vue 作为插件，因此转到`main.js`，让我们导入它并让 Vue 知道我们要将其注册为所有应用程序的插件。在`import App`行之后添加以下代码：

```js
import VueMask from 'v-mask'
Vue.use(VueMask);
```

现在我们已经注册了我们的插件，我们可以访问一个新的指令：`v-mask`。我们可以直接将这个新指令添加到我们的`<input>`元素上，该库将通过读取用户的输入并调整字段的显示来处理幕后的掩码。

首先让我们在常规输入上尝试一下，然后我们将向我们项目的组件添加一些属性：

1.  转到`App.vue`，在电子邮件输入后创建一个新的`<input>`元素：

```js
<input type="text" />
```

如果我们在此字段中输入电话号码，我们将获得默认的输入行为。什么都可以。因此，让我们对其应用`telephone`号码掩码。我们的新`v-mask`库要求我们将其应用到的每个字段都需要进行 v 模型化，因此让我们首先完成这项工作。

1.  在`form`对象的`data()`中添加一个新的`telephone`属性：

```js
form: {
    ...
 telephone: ''
},
```

1.  现在，返回到我们的新`<input>`元素并应用`v-model`。我们现在还将添加`v-mask`指令，如下所示：

```js
<input 
 type="text"
 v-model="form.telephone"
 v-mask="'(###)###-####'"
>
```

返回浏览器，再次尝试输入。当您输入时，您将看到它被很好地格式化为我们期望的电话号码。

在五个简单的步骤中，我们已经为我们的一个表单字段添加了输入掩码。在下一节中，我们将更深入地了解`v-mask`指令为我们做了什么。

# 探索 v-mask 指令

当我们将`v-mask`库添加到我们的项目中，并在`main.js`中添加了插件时，该库为我们创建了一个新的指令`v-mask`。但是，指令到底是什么？我们知道它看起来像 HTML 属性，但还有什么？

指令可以定义如下：

“指令是带有`v-`前缀的特殊属性。指令属性值预期是*单个 JavaScript 表达式*（除了`v-for […]`之外）。指令的作用是在其表达式的值发生变化时，对 DOM 应用响应式的副作用。”- 官方 Vue 文档。

好的，看起来我们有一个特殊的属性可以修改元素。这听起来就像我们在应用到输入元素时看到的情况。但是，我们放入此指令的实际表达式或值是如何工作的呢？

我们从示例中知道我们正在传递一个字符串，并且您可以看到在组成`v-mask=""`属性的双引号内，我们设置了一对新的单引号（`'`）。这意味着此属性内的表达式是 JavaScript，并且我们正在传递给它一个字符串值。

从查看`v-mask`库文档，我们知道我们有一些*特殊*的占位符字符，可以在我们的掩码中使用。这些特殊字符如下表所示：

| `#` | 数字（0-9） |
| --- | --- |
| `A` | 任何大小写字母（a-z，A-Z） |
| `N` | 数字或字母 |
| `X` | 任何符号 |
| `?` | 可选的（下一个字符） |

以显示一天中的时间为例；您可以将其定义如下：

```js
v-mask="'##:##'"
```

这意味着此输入将接受两个数字，从 0 到 9（`##`），后跟一个`:`字符，然后是另外两个数字（`##`）。

任何不符合此模式的内容都将被输入忽略。

`v-mask`是一个非常强大的库，它允许我们通过组合这些简单的规则来自定义我们希望输入如何显示。在下一节中，我们将修改我们的自定义输入，以便能够利用输入掩码的功能。

# 增强我们的自定义输入

我们已经付出了很多工作来创建我们的令人敬畏的自定义`BaseInput`，所以我们肯定希望继续使用它！

按照以下步骤修改`BaseInput`并允许输入掩码：

1.  回到`App.vue`并将`<input>`元素切换为`<BaseInput>`组件：

```js
<BaseInput 
label="Telephone"
 type="text"
 v-model="form.telephone"
/>
```

现在让我们进入`BaseInput.vue`并创建一个新的 prop；我们将称其为`mask`，并将其默认为一个空字符串。重要的是将其默认为一个空字符串，否则指令将尝试匹配它，如果没有声明掩码，我们将无法在字段中输入！

1.  将其添加到您的`props`对象中：

```js
...,
mask: {
type: String,
required: false
}
```

1.  现在，回到`App.vue`并更新我们的电话`BaseInput`以使用`mask`属性：

```js
<BaseInput 
label="Telephone"
type="text" 
v-model="form.telephone"
 :mask="'(###)###-####'"
/>
```

全部完成！返回到您的浏览器，并在字段中添加一些数字，您应该可以看到一个漂亮的电话掩码与您的自定义组件一起工作！

# 总结

在本章中，我们已经学会了如何利用`v-mask`库的强大功能来对我们的表单应用输入掩码。输入掩码是一种强大而简单的方式，可以为用户提供更好的体验，在构建甚至是最简单的表单时，不应忽视它！

在下一章中，我们将进一步学习并查看如何使用强大的库`Vuelidate`进行表单验证！
